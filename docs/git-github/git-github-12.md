---
sidebar_position: 12
tags: ['git']
description: 'git 안쓰는 브랜치 정리'
draft: true
---

# git 안쓰는 브랜치 정리(git prune)

```sh
git prune
```

위 명령으로 로컬 브랜치를 정리할 수 있습니다.

```sh
git gc
```

위 명령도 비슷합니다. 하지만 성능 최적화를 합니다. 아직 지금보다 더 거대한 규모의 레포를 다룬 경험이 없어서 필요성을 아직 경험한적이 없습니다.

---

<!-- `git prune` 명령은 보통 `git fetch`나 `git pull` 등을 통해 원격 저장소에서 가져온 이후에 로컬 저장소에서 더 이상 필요하지 않게 된 객체(주로 커밋)를 정리하는 데 사용됩니다. Git에서는 이러한 객체들을 "dangling" 또는 "loose" 객체라고 부릅니다. 이 객체들은 더 이상 어떤 브랜치나 태그에도 연결되어 있지 않기 때문에, 저장소를 정리하고 공간을 확보하는 데 유용합니다.

`git prune`은 보통 다음과 같은 상황에서 유용합니다:

1. 특정 커밋이나 브랜치가 더 이상 필요하지 않을 때,
2. 원격 저장소에서 삭제된 브랜치가 로컬에는 남아 있을 때,
3. 오래되거나 불필요한 데이터를 정리하고 싶을 때.

기본적으로, `git prune`은 직접 사용되기보다는 `git gc` 명령의 일부로 자동으로 실행되곤 합니다. `git gc` 명령은 여러 가지 정리 작업을 수행하는데, 그 중 하나가 `git prune`을 이용한 dangling 객체의 정리입니다.

`git prune`을 직접 실행하고자 할 때에는 다음과 같은 명령어를 사용합니다:

```shell
git prune
```

`git prune` 명령을 사용할 때는 주의가 필요합니다. 한번 삭제된 데이터는 복구가 어렵기 때문에, 실수로 중요한 데이터를 잃지 않도록 주의해야 합니다.

`git gc` 명령어는 'garbage collection'의 약어로, Git에서 쓸모없게 된 객체를 정리하고, 저장소의 여러 파일을 최적화하는데 사용됩니다. 이 명령어는 다음과 같은 작업을 수행합니다:

1. **불필요한 파일 정리**: 더 이상 어떠한 브랜치나 태그에도 속하지 않는 'dangling' 객체들을 제거합니다. 이는 내부적으로 `git prune` 명령어를 사용합니다.

2. **팩 파일 최적화**: 여러 개의 작은 객체를 하나의 '팩(pack)' 파일로 압축하여 Git의 성능을 향상시킵니다. 이 과정에서는 `git pack-objects` 백엔드 명령어가 사용됩니다.

3. **리팩(refs) 최적화**: 태그와 브랜치를 포함하는 참조(refs) 파일들을 정리하고 최적화합니다.

4. **로그와 리팩 정보 갱신**: `reflog`와 같은 로그 파일들을 정리하고 필요 없는 항목들을 제거합니다.

`git gc`는 일반적으로 사용자가 명시적으로 호출하지 않아도 자동으로 실행됩니다. Git은 일정한 조건(예: 특정 수의 loose 객체가 있을 때, 팩 파일의 개수가 특정 수를 넘어설 때 등)이 충족되면 내부적으로 `git gc`를 호출하여 저장소를 관리합니다. 그러나 저장소의 성능을 개선하고 싶을 때 사용자가 수동으로 실행할 수도 있습니다.

명령어 사용법은 다음과 같습니다:

```shell
git gc
```

저장소의 크기를 줄이고 성능을 향상시키기 위해 주기적으로 `git gc`를 실행하는 것이 좋습니다. 그러나 큰 저장소에서는 이 명령어가 상당한 시간을 소요할 수 있으니, 실행 전에는 충분한 시간이 확보되었는지 확인해야 합니다.

Git에서 "dangling" 객체는 더 이상 어떤 브랜치나 태그, 다른 Git 객체에도 참조되지 않는 객체를 말합니다. 여기에는 주로 다음과 같은 종류의 객체들이 포함됩니다:

1. **커밋(Commits)**: 작업 중에 만들어졌지만 최종적으로 어떤 브랜치에도 속하지 않게 된 커밋들입니다. 예를 들어, 브랜치를 체크아웃하고 커밋을 만든 다음 해당 브랜치를 삭제하면, 그 커밋은 더 이상 참조되지 않게 됩니다.

2. **트리(Trees)**: 파일과 디렉토리의 구조를 저장하는 Git 객체로, 더 이상 커밋에 연결되지 않은 트리들입니다.

3. **블롭(Blobs)**: 파일의 내용을 저장하는 객체로, 트리나 커밋에 더 이상 포함되지 않은 파일의 내용입니다.

4. **태그(Tags)**: 특정 커밋을 가리키는 참조로, 더 이상 유효하지 않은 커밋을 가리키는 태그들이 여기에 해당될 수 있습니다.

"dangling" 객체들은 여러가지 이유로 생길 수 있습니다. 예를 들어, 사용자가 새로운 커밋을 만들고 난 후 브랜치를 다시 체크아웃하는 과정에서 중간에 생성된 커밋이나, 병합 과정에서 발생한 일시적인 커밋 등이 이에 해당합니다. 이러한 객체들은 일반적으로 Git 작업의 부산물로 생기며, 대부분은 필요하지 않게 되므로 안전하게 제거될 수 있습니다.

Git은 이러한 "dangling" 객체들을 자동으로 제거하지 않습니다. 대신, 사용자가 명시적으로 `git prune`이나 `git gc`와 같은 명령어를 사용하여 수동으로 정리할 수 있습니다. 이러한 객체들은 가끔 실수로 중요한 데이터를 삭제했을 때 유용하게 사용될 수 있기 때문에, Git은 사용자가 직접 정리하도록 선택권을 제공합니다.
 -->
